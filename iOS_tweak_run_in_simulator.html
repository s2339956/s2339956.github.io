<!DOCTYPE HTML>
<html lang="zh-TW">

<head>
    <!--Setting-->
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, user-scalable=no, initial-scale=1.0, maximum-scale=1.0, minimum-scale=1.0">
    <meta http-equiv="X-UA-Compatible" content="IE=Edge,chrome=1">
    <meta http-equiv="Cache-Control" content="no-siteapp">
    <meta http-equiv="Cache-Control" content="no-transform">
    <meta name="renderer" content="webkit|ie-comp|ie-stand">
    <meta name="apple-mobile-web-app-capable" content="Tin Blog">
    <meta name="apple-mobile-web-app-status-bar-style" content="black">
    <meta name="format-detection" content="telephone=no,email=no,adress=no">
    <meta name="browsermode" content="application">
    <meta name="screen-orientation" content="portrait">
    <meta name="theme-version" content="1.3.0">
    <meta name="root" content="/">
    <link rel="dns-prefetch" href="http://s2339956.github.io">
    <!--SEO-->

<meta name="keywords" content="iOS,tweak" />


<meta name="description" content="　　iOS tweak run in Simulator



模擬器測試的優點
功能基本和實體機一樣
模擬器無需越獄，因此可以在新系統無法越獄時第一時間進行適配
可測試各種 iOS 版本、設備..." />


<meta name="robots" content="all" />
<meta name="google" content="all" />
<meta name="googlebot" content="all" />
<meta name="verify" content="all" />
    <!--Title-->

<title>
    
    iOS tweak run in Simulator |
    
    Tin Blog
</title>

<link rel="alternate" href="/atom.xml" title="Tin Blog" type="application/atom+xml">


<link rel="icon" href="/img/favicon.png">

    


<link rel="stylesheet" href="/css/bootstrap.min.css?rev=3.3.7.css">
<link rel="stylesheet" href="/css/font-awesome.min.css?rev=4.7.0.css">
<link rel="stylesheet" href="/css/style.css?rev=@@hash.css">

    
<div class="hide">
    <script type="text/javascript">
    var cnzz_protocol = (("https:" == document.location.protocol) ? " https://" : " http://");
    document.write(unescape("%3Cspan class='cnzz_stat_icon_1263868967 hide' %3E%3Cscript%20src%3D%22https%3A%2F%2Fs95.cnzz.com%2Fz_stat.php%3Fweb_id%3D1272564536%22%3E%3C%2Fscript%3E%3C/span%3E%3Cscript src='" + cnzz_protocol + "s19.cnzz.com/z_stat.php%3Fid%3D1263868967%26show%3Dpic1' type='text/javascript'%3E%3C/script%3E"));
    </script>
</div>



<script>
(function(i, s, o, g, r, a, m) {
    i['GoogleAnalyticsObject'] = r;
    i[r] = i[r] || function() {
        (i[r].q = i[r].q || []).push(arguments)
    }, i[r].l = 1 * new Date();
    a = s.createElement(o),
        m = s.getElementsByTagName(o)[0];
    a.async = 1;
    a.src = g;
    m.parentNode.insertBefore(a, m)
})(window, document, 'script', 'https://www.google-analytics.com/analytics.js', 'ga');
ga('create', 'UA-109722991-1', 'auto');
ga('send', 'pageview');
</script>


    

<meta name="generator" content="Hexo 5.2.0"></head>
<!--[if lte IE 8]>
<style>
    html{ font-size: 1em }
</style>
<![endif]-->
<!--[if lte IE 9]>
<div style="ie">你使用的浏览器版本过低，为了你更好的阅读体验，请更新浏览器的版本或者使用其他现代浏览器，比如Chrome、Firefox、Safari等。</div>
<![endif]-->
<body>
    <header class="main-header"  style="background-image:url(
    https://hexo-theme-snippet-1251680922.cos.ap-beijing.myqcloud.com/img/banner.jpg)"
     >
    <div class="main-header-box">
        <a class="header-avatar" href="/" title='Tin'>
            <img src="/img/avatar.jpg" alt="logo头像" class="img-responsive center-block">
        </a>
        <div class="branding">
            <!--<h2 class="text-hide">Snippet主题,从未如此简单有趣</h2>-->
            
            <h2>
                星星給予仰望者光芒
            </h2>
            
        </div>
    </div>
</header>
    <nav class="main-navigation">
    <div class="container">
        <div class="row">
            <div class="col-sm-12">
                <div class="navbar-header"><span class="nav-toggle-button collapsed pull-right" data-toggle="collapse" data-target="#main-menu" id="mnav">
                        <span class="sr-only"></span>
                        <i class="fa fa-bars"></i>
                    </span>
                    <a class="navbar-brand" href="http://s2339956.github.io">
                        Tin Blog</a>
                </div>
                <div class="collapse navbar-collapse" id="main-menu">
                    <ul class="menu">
                        
                        <li role="presentation" class="text-center">
                            <a href="/"><i class="fa fa-home"></i>
                                首頁</a>
                        </li>
                        
                        <li role="presentation" class="text-center">
                            <a href="/archives/"><i class="fa fa-archive"></i>
                                彙整</a>
                        </li>
                        
                        <li role="presentation" class="text-center">
                            <a href="/about/"><i class="fa fa-user"></i>
                                About</a>
                        </li>
                        
                        <li role="presentation" class="text-center">
                            <a href="/archives/"><i class="fa fab fa-line"></i>
                                時間軸</a>
                        </li>
                        
                    </ul>
                </div>
            </div>
        </div>
    </div>
</nav>
    <section class="content-wrap">
        <div class="container">
            <div class="row">
                <main class="col-md-8 main-content m-post">
                    <p id="process"></p>
<article class="post">
    <div class="post-head">
        <h1 id="iOS tweak run in Simulator">
            
            iOS tweak run in Simulator
            
        </h1>
        <div class="post-meta">
    
    <span class="categories-meta fa-wrap">
        <i class="fa fa-folder-open-o"></i>
        <a class="category-link" href="/categories/iOS/">iOS</a> <a class="category-link" href="/categories/iOS/tweak/">tweak</a>
    </span>
    
    
    <span class="fa-wrap">
        <i class="fa fa-tags"></i>
        <span class="tags-meta">
            
            <a class="tag-none-link" href="/tags/iOS/" rel="tag">iOS</a> <a class="tag-none-link" href="/tags/tweak/" rel="tag">tweak</a>
            
        </span>
    </span>
    
    
    
    <span class="fa-wrap">
        <i class="fa fa-clock-o"></i>
        <span class="date-meta">
            2022/03/18</span>
    </span>
    
    <span class="fa-wrap">
        <i class="fa fa-eye"></i>
        <span id="busuanzi_value_page_pv"></span>
    </span>
    
    
</div>
        
        
    </div>
    
    <div class="post-body post-content">
        <p>　　iOS tweak run in Simulator</p>
<a id="more"></a>


<h2 id="模擬器測試的優點"><a href="#模擬器測試的優點" class="headerlink" title="模擬器測試的優點"></a>模擬器測試的優點</h2><ol>
<li>功能基本和實體機一樣</li>
<li>模擬器無需越獄，因此可以在新系統無法越獄時第一時間進行適配</li>
<li>可測試各種 iOS 版本、設備</li>
<li>繼承模擬器本身的優點</li>
</ol>
<h3 id="測試環境"><a href="#測試環境" class="headerlink" title="測試環境"></a>測試環境</h3><ol>
<li>x64 macOS(11.5.2)</li>
<li>Xcode 12.4</li>
<li>Simulator(iphone 11 pro)</li>
</ol>
<ul>
<li>工具<ol>
<li><a target="_blank" rel="noopener" href="https://theos.dev/docs/parallel-building">theos</a>: 編譯工具</li>
<li><a target="_blank" rel="noopener" href="https://github.com/akemin-dayo/simject">simject</a>: 作為Tweak Loader加載我們的dylib</li>
<li><a target="_blank" rel="noopener" href="https://github.com/sbingner/substitute">substitute</a>: CydiaSubstrate</li>
<li>python 3.6 ~ 3.8</li>
</ol>
</li>
</ul>
<ul>
<li>原理: 使用 Theos 編譯出模擬器架構(x86_64)的 dylib，由 simject 進行加載。arm 上是由 CydiaSubstrate 為我們進行加載的。</li>
</ul>
<h2 id="步驟"><a href="#步驟" class="headerlink" title="步驟"></a>步驟</h2><h4 id="安裝-simject"><a href="#安裝-simject" class="headerlink" title="安裝 simject"></a>安裝 simject</h4><ol>
<li><code>git clone https://github.com/angelXwind/simject.git</code></li>
<li><code>cd simject/</code></li>
<li><code>make setup</code></li>
</ol>
<ul>
<li>安裝後會新增資料夾 /opt/simject 實質是對應實體機上的 /Library/MobileSubstrate/DynamicLibraries，後續把編譯完成的 dylib 和 plist 放在這裡，simject 就會幫我們加載。</li>
<li>安裝後會新增命令行工具 resim, 類似 sbreload，可用於重啓模擬器的 SpringBoard。</li>
<li>每個模擬器啓動後，並不會自動加載 simject，每次都需要執行 <code>resim</code> 一次，之後僅需在需要 sbreload 時再 <code>resim</code></li>
</ul>
<h4 id="安裝Cydia-Substrate"><a href="#安裝Cydia-Substrate" class="headerlink" title="安裝Cydia Substrate"></a>安裝Cydia Substrate</h4><p>simject 提供了一個腳本幫我們自動安裝好 Cydia Substrate</p>
<ul>
<li>如果是Xcode 10 或者 以上 <code>sudo ./installsubstrate.sh subst</code> </li>
<li>Xcode10 以下 使用 <code>sudo ./installsubstrate.sh cs</code></li>
</ul>
<h4 id="測試"><a href="#測試" class="headerlink" title="測試"></a>測試</h4><p>simject 提供了 simjectExampleTweak 這個 demo 供我們進行測試</p>
<ol>
<li><code>cd  simjectExampleTweak</code></li>
<li>在 Makefile 中加入 <code>TARGET = simulator:clang::7.0</code> 、<code>_LOGOSFLAGS += -c</code>、<code>generator=MobileSubstrate</code><br> <img src="/images/iOS_tweak_run_in_simulator/bdfb6ffb942b2dd1ab178f7c2e3a791c.png" alt></li>
<li><code>make setup</code></li>
<li><code>cp -R simject/simjectExampleTweak/.theos/obj/iphone_simulator/x86_64/simjectExampleTweak.dylib /opt/simject/</code> </li>
<li><code>cp -R simject/simjectExampleTweak/simjectExampleTweak.plist opt/simject/</code></li>
<li>打開模擬器(Simulator) </li>
<li><code>resim</code></li>
<li>可以看到模擬器已被重啓，並彈出了一個 AlertView</li>
</ol>
<p><img src="/images/iOS_tweak_run_in_simulator/8f8df7525f24aaa48311d02a11c0643c.png" alt></p>
<h3 id="注意"><a href="#注意" class="headerlink" title="注意"></a>注意</h3><p>Tweak 每次重新編譯後，都需要重新複製到 opt/simject/，請先刪除原有檔案，在複製進去，否則會 crash loop</p>

    </div>
    
    <div class="post-footer">
        <div>
            
            轉載聲明：
            商業轉載請聯繫作者獲得授權, 非商業轉載請註明出處 © <a href="" target="_blank">TinXie</a>
            
            
        </div>
        <div>
            
        </div>
    </div>
</article>
<div class="article-nav prev-next-wrap clearfix">
    
    
    <a href="/sublimetext_save_file_is_readonly.html" class="next-post btn btn-default" title='Sublime Text save file is readonly'>
        <span class="hidden-lg">下一篇</span>
        <span class="hidden-xs">
            Sublime Text save file is readonly</span><i class="fa fa-angle-right fa-fw"></i>
    </a>
    
</div>

<div id="comments">
    
    <link rel="stylesheet" href="https://cdn.bootcss.com/gitalk/1.4.1/gitalk.min.css">
<script src="//cdn.bootcss.com/gitalk/1.4.1/gitalk.min.js"></script>
<script src="//cdn.bootcss.com/blueimp-md5/2.9.0/js/md5.min.js"></script>
<div id="gitalk-container"></div>
<script type="text/javascript">
var gitalk = new Gitalk({
    // Gitalk配置
    language: "zh-TW",
    clientID: "963ce46b3653bea85cac",
    clientSecret: "e3e6d59e4e9b0b7c7d639a92decbdfecc771e67e",
    repo: "s2339956.github.is",
    owner: "s2339956",
    admin: ["s2339956"],
    id: md5(location.pathname),
    distractionFreeMode: true
});
gitalk.render('gitalk-container');
</script>

</div>

                </main>
                
                    <aside id="article-toc" role="navigation" class="col-md-4">
    <div class="widget">
        <h3 class="title">
            文章目錄
        </h3>
        
        <ol class="toc"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E6%A8%A1%E6%93%AC%E5%99%A8%E6%B8%AC%E8%A9%A6%E7%9A%84%E5%84%AA%E9%BB%9E"><span class="toc-text">模擬器測試的優點</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%B8%AC%E8%A9%A6%E7%92%B0%E5%A2%83"><span class="toc-text">測試環境</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E6%AD%A5%E9%A9%9F"><span class="toc-text">步驟</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%AE%89%E8%A3%9D-simject"><span class="toc-text">安裝 simject</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%AE%89%E8%A3%9DCydia-Substrate"><span class="toc-text">安裝Cydia Substrate</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E6%B8%AC%E8%A9%A6"><span class="toc-text">測試</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%B3%A8%E6%84%8F"><span class="toc-text">注意</span></a></li></ol></li></ol>
        
    </div>
</aside>
                
            </div>
        </div>
    </section>
    <footer class="main-footer">
    <div class="container">
        <div class="row">
        </div>
    </div>
</footer>
<a id="back-to-top" class="icon-btn hide">
    <i class="fa fa-chevron-up"></i>
</a>
    <div class="copyright">
    <div class="container">
        <div class="row">
            <div class="col-sm-12">
                <div class="busuanzi">
    
    訪問量:
    <strong id="busuanzi_value_site_pv">
        <i class="fa fa-spinner fa-spin"></i>
    </strong>
    &nbsp; | &nbsp;
    訪客數:
    <strong id="busuanzi_value_site_uv">
        <i class="fa fa-spinner fa-spin"></i>
    </strong>
    
</div>
            </div>
            <div class="col-sm-12">
                <span>Copyright &copy;
                    2017
                    
                </span> |
                <span>
                    Powered by <a href="//hexo.io" class="copyright-links" target="_blank" rel="nofollow">Hexo</a>
                </span> |
                <span>
                    Theme by <a href="//github.com/shenliyang/hexo-theme-snippet.git" class="copyright-links" target="_blank" rel="nofollow">Snippet</a>
                </span>
            </div>
        </div>
    </div>
</div>



<script async src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script>


<script src="/js/app.js?rev=@@hash.js"></script>

</body>
</html>